<!DOCTYPE html>
<html lang="pt" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/layout :: head('FastDev - Login/Cadastro')"></head>
<body style="background-color:#121212;color:#E0E0E0;line-height:1.6;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0;">
  <div class="auth-container" style="background-color:#222;padding:40px;border-radius:15px;width:100%;max-width:400px;box-shadow:0 10px 20px rgba(0,0,0,.5);">
    <div class="logo" style="font-size:28px;font-weight:bold;letter-spacing:1px;color:#E0E0E0;text-align:center;margin-bottom:30px;">FAST<span style="color:#D32F2F;">D</span>EV</div>

    <div class="tabs" style="display:flex;justify-content:space-around;margin-bottom:30px;">
      <div id="tab-login" class="tab active" style="flex:1;text-align:center;padding:10px 0;font-size:18px;color:#B0BEC5;cursor:pointer;transition:color .3s,border-bottom .3s;border-bottom:2px solid #D32F2F;">Login</div>
      <div id="tab-register" class="tab" style="flex:1;text-align:center;padding:10px 0;font-size:18px;color:#B0BEC5;cursor:pointer;transition:color .3s,border-bottom .3s;border-bottom:2px solid transparent;">Cadastro</div>
    </div>

    <div id="alert" style="display:none;background:#3b1d1d;color:#ffcaca;padding:10px;border-radius:6px;margin-bottom:12px;"></div>
    <div id="success" style="display:none;background:#1d3b24;color:#caffd2;padding:10px;border-radius:6px;margin-bottom:12px;"></div>

    <div id="login" class="form-container active">
      <form id="login-form">
        <div class="form-group" style="margin-bottom:20px;">
          <label for="login-email" style="display:block;font-size:14px;color:#B0BEC5;margin-bottom:5px;">E-mail ou usuário</label>
          <input type="text" id="login-email" placeholder="Digite seu login" required style="width:100%;padding:12px;border:none;border-radius:5px;background-color:#333;color:#E0E0E0;font-size:16px;outline:none;transition:background .3s;">
        </div>
        <div class="form-group" style="margin-bottom:20px;">
          <label for="login-password" style="display:block;font-size:14px;color:#B0BEC5;margin-bottom:5px;">Senha</label>
          <input type="password" id="login-password" placeholder="Digite sua senha" required style="width:100%;padding:12px;border:none;border-radius:5px;background-color:#333;color:#E0E0E0;font-size:16px;outline:none;transition:background .3s;">
        </div>
        <button type="submit" class="btn" style="display:block;width:100%;background:#D32F2F;color:#E0E0E0;padding:12px;text-decoration:none;border:none;border-radius:5px;font-weight:bold;font-size:16px;cursor:pointer;transition:background .3s,transform .2s;">Entrar</button>
        <div class="forgot-password" style="text-align:center;margin-top:15px;">
          <a href="#" style="color:#B0BEC5;text-decoration:none;font-size:14px;transition:color .3s;">Esqueceu sua senha?</a>
        </div>
      </form>
    </div>

    <div id="register" class="form-container" style="display:none;">
      <form id="register-form">
        <div class="form-group" style="margin-bottom:20px;">
          <label for="register-name" style="display:block;font-size:14px;color:#B0BEC5;margin-bottom:5px;">Nome</label>
          <input type="text" id="register-name" placeholder="Digite seu nome" required style="width:100%;padding:12px;border:none;border-radius:5px;background-color:#333;color:#E0E0E0;font-size:16px;outline:none;transition:background .3s;">
        </div>
        <div class="form-group" style="margin-bottom:20px;">
          <label for="register-email" style="display:block;font-size:14px;color:#B0BEC5;margin-bottom:5px;">Login</label>
          <input type="text" id="register-email" placeholder="Seu login" required style="width:100%;padding:12px;border:none;border-radius:5px;background-color:#333;color:#E0E0E0;font-size:16px;outline:none;transition:background .3s;">
        </div>
        <div class="form-group" style="margin-bottom:20px;">
          <label for="register-password" style="display:block;font-size:14px;color:#B0BEC5;margin-bottom:5px;">Senha</label>
          <input type="password" id="register-password" placeholder="Crie uma senha" required style="width:100%;padding:12px;border:none;border-radius:5px;background-color:#333;color:#E0E0E0;font-size:16px;outline:none;transition:background .3s;">
        </div>
        <div class="form-group" style="margin-bottom:20px;">
          <label for="register-nome-completo" style="display:block;font-size:14px;color:#B0BEC5;margin-bottom:5px;">Nome completo</label>
          <input type="text" id="register-nome-completo" placeholder="Seu nome completo" style="width:100%;padding:12px;border:none;border-radius:5px;background-color:#333;color:#E0E0E0;font-size:16px;outline:none;transition:background .3s;">
        </div>
        <div class="form-group" style="margin-bottom:20px;">
          <label for="register-telefone" style="display:block;font-size:14px;color:#B0BEC5;margin-bottom:5px;">Telefone</label>
          <input type="text" id="register-telefone" placeholder="Seu telefone" style="width:100%;padding:12px;border:none;border-radius:5px;background-color:#333;color:#E0E0E0;font-size:16px;outline:none;transition:background .3s;">
        </div>
        <button type="submit" class="btn" style="display:block;width:100%;background:#D32F2F;color:#E0E0E0;padding:12px;text-decoration:none;border:none;border-radius:5px;font-weight:bold;font-size:16px;cursor:pointer;transition:background .3s,transform .2s;">Cadastrar</button>
      </form>
    </div>
  </div>

  <footer style="text-align:center;padding:20px;background:#222;position:fixed;bottom:0;width:100%;font-size:14px;color:#B0BEC5;">
    <p>FastDev © 2025 - Todos os direitos reservados</p>
  </footer>

  <script>
    const tabLogin=document.getElementById('tab-login')
    const tabRegister=document.getElementById('tab-register')
    const loginBox=document.getElementById('login')
    const registerBox=document.getElementById('register')
    const alertBox=document.getElementById('alert')
    const successBox=document.getElementById('success')

    function switchTab(which){
      if(which==='login'){
        loginBox.style.display='block'
        registerBox.style.display='none'
        tabLogin.style.borderBottom='2px solid #D32F2F'
        tabRegister.style.borderBottom='2px solid transparent'
      }else{
        registerBox.style.display='block'
        loginBox.style.display='none'
        tabRegister.style.borderBottom='2px solid #D32F2F'
        tabLogin.style.borderBottom='2px solid transparent'
      }
      alertBox.style.display='none'
      successBox.style.display='none'
    }

    tabLogin.addEventListener('click',()=>switchTab('login'))
    tabRegister.addEventListener('click',()=>switchTab('register'))

    document.getElementById('login-form').addEventListener('submit',async e=>{
      e.preventDefault()
      const login=document.getElementById('login-email').value.trim()
      const password=document.getElementById('login-password').value
      alertBox.style.display='none'
      successBox.style.display='none'
      try{
        const r=await fetch('/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({login,password})})
        if(!r.ok){throw new Error('erro')}
        const data=await r.json()
        if(data&&data.token){localStorage.setItem('fastdev_token',data.token);window.location.href='/web'}
        else{successBox.style.display='block';successBox.textContent='Login realizado.'}
      }catch(err){
        alertBox.style.display='block'
        alertBox.textContent='Credenciais inválidas'
      }
    })

    document.getElementById('register-form').addEventListener('submit',async e=>{
      e.preventDefault()
      const nome=document.getElementById('register-name').value.trim()
      const login=document.getElementById('register-email').value.trim()
      const password=document.getElementById('register-password').value
      const nomeCompleto=document.getElementById('register-nome-completo').value.trim()
      const telefone=document.getElementById('register-telefone').value.trim()
      alertBox.style.display='none'
      successBox.style.display='none'
      try{
        const r=await fetch('/auth/register-visualizador',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({nome,login,password,nomeCompleto,telefone})})
        if(!r.ok){throw new Error('erro')}
        successBox.style.display='block'
        successBox.textContent='Cadastro realizado. Faça login.'
        switchTab('login')
      }catch(err){
        alertBox.style.display='block'
        alertBox.textContent='Não foi possível cadastrar'
      }
    })
  </script>
</body>
</html>
